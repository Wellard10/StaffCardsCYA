table 'DIM BARRIER (2)'
	lineageTag: 617f82cd-b746-486d-9029-20c6d0c62ded

	column Barriers
		dataType: string
		lineageTag: 96943a67-a0b1-4d94-8834-64c96628a302
		summarizeBy: none
		sourceColumn: Barriers

		annotation SummarizationSetBy = Automatic

	partition 'DIM BARRIER (2)' = m
		mode: import
		source =
				let
				    Source = Table.Combine({DOPeople, BFPeople, InfraPeople}),
				    #"Removed Other Columns" = Table.SelectColumns(Source,{"Barriers"}),
				    #"Replaced Value2" = Table.ReplaceValue(#"Removed Other Columns","Migrant, people with a foreign background, minorities (inc marginalised communities such as Roma)","Migrant; people with a foreign background; minorities (inc marginalised communities such as Roma)",Replacer.ReplaceText,{"Barriers"}),
				    #"Split Column by Delimiter" = Table.ExpandListColumn(Table.TransformColumns(#"Replaced Value2", {{"Barriers", Splitter.SplitTextByDelimiter(",", QuoteStyle.Csv), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), "Barriers"),
				    #"Filtered Rows" = Table.SelectRows(#"Split Column by Delimiter", each [Barriers] <> null and [Barriers] <> ""),
				    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows","(Please state below)","",Replacer.ReplaceText,{"Barriers"}),
				    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value"," (Aged up to 24 with a continuous JSA/UC claim of 6 month or more","",Replacer.ReplaceText,{"Barriers"}),
				    #"Trimmed Text" = Table.TransformColumns(#"Replaced Value1",{{"Barriers", Text.Trim, type text}}),
				    #"Cleaned Text" = Table.TransformColumns(#"Trimmed Text",{{"Barriers", Text.Clean, type text}}),
				    #"Removed Duplicates" = Table.Distinct(#"Cleaned Text")
				in
				    #"Removed Duplicates"

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

